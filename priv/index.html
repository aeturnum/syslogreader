<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <style type="text/css">
        body {
            background-color: #1a1a1a;
            color: white;
            margin: 0;
        }

        main {
            position: absolute;
            top: 40px;
            bottom: 20px;
            width: 100%;
            height: 100%;
        }
    </style>
    <title>
        Syslog watcher
    </title>
</head>

<body>
    <main id="main"></main>
    <script type="application/javascript">

        class myWebsocketHandler {
            setupSocket() {
                let loc = window.location;
                this.socket = new WebSocket(`wss://${loc.hostname}/ws`)
                // this.socket = new WebSocket(`wss://admin.drex.space/ws`)

                this.socket.addEventListener("message", (event) => {
                    let textBox = document.getElementById("main");
                    textBox.appendChild(document.createTextNode(event.data));
                    textBox.appendChild(document.createElement("br")).scrollIntoView(false);
                })

                this.socket.addEventListener("close", () => {
                    this.setupSocket()
                })
            }

        }

        const websocketClass = new myWebsocketHandler()
        websocketClass.setupSocket()

    </script>
</body>

</html>